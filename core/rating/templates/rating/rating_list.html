{% extends 'base.html' %}

{% block title %}–†–µ–π—Ç–∏–Ω–≥ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ - BAITC | RedOrda{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ -->
    <div class="text-center">
        <h1 class="text-3xl font-bold text-gray-900">–†–µ–π—Ç–∏–Ω–≥ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</h1>
        <p class="mt-2 text-gray-600">–†–µ–π—Ç–∏–Ω–≥ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —É—á–∞—Å—Ç–∏—è –≤ —Ö–∞–∫–∞—Ç–æ–Ω–∞—Ö, –∫–µ–π—Å-—á–µ–º–ø–∏–æ–Ω–∞—Ç–∞—Ö –∏ –≤–µ–±–∏–Ω–∞—Ä–∞—Ö</p>
    </div>

    <!-- –§–∏–ª—å—Ç—Ä—ã -->
    <div class="bg-white rounded-xl shadow-sm p-6">
        <form method="get" class="space-y-4">
            <input type="hidden" name="hash" value="{{ user.hash_code }}">
            
            <!-- –ü–æ–∏—Å–∫ -->
            <div class="flex gap-4">
                <div class="flex-1">
                    <input type="text" 
                           name="search" 
                           value="{{ current_search }}" 
                           placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏..." 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>
                <button type="submit" class="btn-primary">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                    </svg>
                </button>
            </div>

            <!-- –°–µ–ª–µ–∫—Ç–æ—Ä—ã -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <select name="period" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    <option value="all" {% if current_period == 'all' %}selected{% endif %}>–ó–∞ –≤—Å–µ –≤—Ä–µ–º—è</option>
                    <option value="month" {% if current_period == 'month' %}selected{% endif %}>–ó–∞ –º–µ—Å—è—Ü</option>
                    <option value="year" {% if current_period == 'year' %}selected{% endif %}>–ó–∞ –≥–æ–¥</option>
                </select>

                <select name="activity" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    <option value="all" {% if current_activity == 'all' %}selected{% endif %}>–í—Å–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</option>
                    <option value="hackathons" {% if current_activity == 'hackathons' %}selected{% endif %}>–•–∞–∫–∞—Ç–æ–Ω—ã</option>
                    <option value="casecups" {% if current_activity == 'casecups' %}selected{% endif %}>–ö–µ–π—Å-—á–µ–º–ø–∏–æ–Ω–∞—Ç—ã</option>
                    <option value="webinars" {% if current_activity == 'webinars' %}selected{% endif %}>–í–µ–±–∏–Ω–∞—Ä—ã</option>
                </select>
            </div>
        </form>
    </div>

    <!-- –¢–∞–±–ª–∏—Ü–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞ -->
    <div class="bg-white rounded-xl shadow-sm overflow-hidden">
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–†–∞–Ω–≥</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–£—á–∞—Å—Ç–Ω–∏–∫</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ë–∞–ª–ª—ã</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden md:table-cell">–•–∞–∫–∞—Ç–æ–Ω—ã</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden md:table-cell">–ö–µ–π—Å—ã</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden md:table-cell">–í–µ–±–∏–Ω–∞—Ä—ã</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    {% for rating in ratings %}
                    <tr class="{% if rating.user.hash_code == user.hash_code %}bg-blue-50{% endif %} hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                {% if rating.rank == 1 %}
                                    <span class="text-2xl">ü•á</span>
                                {% elif rating.rank == 2 %}
                                    <span class="text-2xl">ü•à</span>
                                {% elif rating.rank == 3 %}
                                    <span class="text-2xl">ü•â</span>
                                {% else %}
                                    <span class="text-sm font-medium text-gray-900">{{ rating.rank }}</span>
                                {% endif %}
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 h-10 w-10">
                                    <img class="h-10 w-10 rounded-full" src="https://ui-avatars.com/api/?name={{ rating.user.username }}&background=random" alt="">
                                </div>
                                <div class="ml-4">
                                    <div class="text-sm font-medium text-gray-900">{{ rating.user.username }}</div>
                                </div>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <span class="text-sm font-medium text-gray-900">{{ rating.points }}</span>
                                {% if rating.points_change > 0 %}
                                    <span class="ml-2 text-xs text-green-600">+{{ rating.points_change }}</span>
                                {% elif rating.points_change < 0 %}
                                    <span class="ml-2 text-xs text-red-600">{{ rating.points_change }}</span>
                                {% endif %}
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap hidden md:table-cell">
                            <span class="text-sm text-gray-900">{{ rating.hackathons_count }}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap hidden md:table-cell">
                            <span class="text-sm text-gray-900">{{ rating.casecups_count }}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap hidden md:table-cell">
                            <span class="text-sm text-gray-900">{{ rating.webinars_count }}</span>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="6" class="px-6 py-4 text-center text-gray-500">
                            –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
    {% if ratings.has_other_pages %}
    <div class="flex justify-center space-x-1">
        {% if ratings.has_previous %}
        <a href="?hash={{ user.hash_code }}&page={{ ratings.previous_page_number }}&search={{ current_search }}&period={{ current_period }}&activity={{ current_activity }}" 
           class="px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-100">
            –ù–∞–∑–∞–¥
        </a>
        {% endif %}

        {% for num in ratings.paginator.page_range %}
            {% if ratings.number == num %}
            <span class="px-4 py-2 text-white bg-blue-600 border border-blue-600 rounded-lg">{{ num }}</span>
            {% else %}
            <a href="?hash={{ user.hash_code }}&page={{ num }}&search={{ current_search }}&period={{ current_period }}&activity={{ current_activity }}" 
               class="px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-100">
                {{ num }}
            </a>
            {% endif %}
        {% endfor %}

        {% if ratings.has_next %}
        <a href="?hash={{ user.hash_code }}&page={{ ratings.next_page_number }}&search={{ current_search }}&period={{ current_period }}&activity={{ current_activity }}" 
           class="px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-100">
            –í–ø–µ—Ä–µ–¥
        </a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %} 