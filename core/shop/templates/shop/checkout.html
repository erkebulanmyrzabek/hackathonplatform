{% extends 'base.html' %}
{% load static %}

{% block title %}–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ | BAITC | RedOrda{% endblock %}

{% block extra_css %}
<style>
    /* –°—Ç–∏–ª–∏ –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ */
    .checkout-container {
        padding-bottom: 40px;
    }
    
    .order-summary {
        background-color: white;
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 24px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .order-summary-title {
        font-weight: 600;
        font-size: 18px;
        margin-bottom: 16px;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    
    .summary-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
        font-size: 14px;
    }
    
    .summary-label {
        color: #6b7280;
    }
    
    .summary-value {
        font-weight: 600;
    }
    
    .total-row {
        display: flex;
        justify-content: space-between;
        margin-top: 16px;
        padding-top: 16px;
        border-top: 1px solid #e5e7eb;
    }
    
    .total-label {
        font-weight: 600;
        font-size: 16px;
    }
    
    .total-value {
        font-weight: 700;
        font-size: 16px;
        color: #ef4444;
    }
    
    .customer-info {
        background-color: white;
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 24px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .form-title {
        font-weight: 600;
        font-size: 18px;
        margin-bottom: 16px;
    }
    
    .form-group {
        margin-bottom: 16px;
    }
    
    .form-label {
        display: block;
        font-size: 14px;
        color: #4b5563;
        margin-bottom: 6px;
    }
    
    .form-input {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        font-size: 16px;
        transition: all 0.3s ease;
    }
    
    .form-input:focus {
        border-color: #3b82f6;
        outline: none;
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3);
    }
    
    .payment-methods {
        background-color: white;
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 24px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .payment-option {
        display: flex;
        align-items: center;
        padding: 12px;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        margin-bottom: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .payment-option:last-child {
        margin-bottom: 0;
    }
    
    .payment-option.selected {
        border-color: #3b82f6;
        background-color: #eff6ff;
    }
    
    .payment-radio {
        margin-right: 12px;
    }
    
    .payment-label {
        font-weight: 600;
    }
    
    .payment-label-sub {
        font-size: 14px;
        color: #6b7280;
        margin-top: 2px;
    }
    
    .crystal-balance {
        color: #4f46e5;
        margin-left: auto;
        display: flex;
        align-items: center;
        font-weight: 600;
    }
    
    .place-order-btn {
        display: block;
        width: 100%;
        padding: 16px;
        border-radius: 8px;
        background-color: #2563eb;
        color: white;
        font-weight: 600;
        font-size: 16px;
        text-align: center;
        margin-top: 20px;
        transition: all 0.3s ease;
        border: none;
        cursor: pointer;
    }
    
    .place-order-btn:hover {
        background-color: #1d4ed8;
    }
    
    .place-order-btn:disabled {
        background-color: #9ca3af;
        cursor: not-allowed;
    }
    
    .error-message {
        color: #ef4444;
        font-size: 14px;
        margin-top: 4px;
    }
    
    /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã */
    .payment-toggle {
        display: flex;
        background-color: #f3f4f6;
        border-radius: 8px;
        padding: 4px;
        margin-bottom: 16px;
    }
    
    .payment-toggle-option {
        flex: 1;
        text-align: center;
        padding: 10px;
        border-radius: 6px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .payment-toggle-option.active {
        background-color: #2563eb;
        color: white;
    }
    
    /* –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ */
    .spinner {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: #fff;
        animation: spin 1s ease-in-out infinite;
        margin-right: 8px;
    }
    
    @keyframes spin {
        to { transform: rotate(360deg); }
    }
</style>
{% endblock %}

{% block content %}
<div class="checkout-container">
    <h1 class="text-2xl font-bold mb-4">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h1>
    
    <!-- –°–≤–æ–¥–∫–∞ –∑–∞–∫–∞–∑–∞ -->
    <div class="order-summary">
        <div class="order-summary-title">
            <span>–í–∞—à –∑–∞–∫–∞–∑</span>
        </div>
        
        <div class="summary-row">
            <span class="summary-label">–¢–æ–≤–∞—Ä–æ–≤ ({{ cart.total_items }})</span>
            <span class="summary-value">{{ cart.total_price|floatformat:"0" }} ‚Ç∏</span>
        </div>
        
        {% if cart.total_crystal_price > 0 %}
        <div class="summary-row">
            <span class="summary-label">–ö—Ä–∏—Å—Ç–∞–ª–ª—ã</span>
            <span class="summary-value">
                <span class="crystal-price">
                    üíé {{ cart.total_crystal_price }}
                </span>
            </span>
        </div>
        {% endif %}
        
        <div class="summary-row">
            <span class="summary-label">–î–æ—Å—Ç–∞–≤–∫–∞</span>
            <span class="summary-value">0 ‚Ç∏</span>
        </div>
        
        <div class="total-row">
            <span class="total-label">–ò—Ç–æ–≥–æ:</span>
            <span class="total-value" id="total-price-display">{{ cart.total_price|floatformat:"0" }} ‚Ç∏</span>
        </div>
    </div>
    
    <form id="checkout-form">
        <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã -->
        <div class="payment-toggle">
            <div class="payment-toggle-option active" data-payment="cash" id="money-payment">
                –î–µ–Ω—å–≥–∏
            </div>
            <div class="payment-toggle-option" data-payment="crystals" id="crystal-payment">
                –ö—Ä–∏—Å—Ç–∞–ª–ª—ã üíé {{ cart.total_crystal_price }}
            </div>
        </div>
        
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ -->
        <div class="customer-info">
            <h2 class="form-title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏</h2>
            
            <div class="form-group">
                <label for="full-name" class="form-label">–§–ò–û*</label>
                <input type="text" id="full-name" name="full_name" class="form-input" required>
                <div class="error-message" id="full-name-error"></div>
            </div>
            
            <div class="form-group">
                <label for="phone" class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω*</label>
                <input type="tel" id="phone" name="phone_number" class="form-input" required>
                <div class="error-message" id="phone-error"></div>
            </div>
            
            <div class="form-group">
                <label for="city" class="form-label">–ì–æ—Ä–æ–¥*</label>
                <input type="text" id="city" name="city" class="form-input" required>
                <div class="error-message" id="city-error"></div>
            </div>
            
            <div class="form-group">
                <label for="address" class="form-label">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏*</label>
                <input type="text" id="address" name="address" class="form-input" required>
                <div class="error-message" id="address-error"></div>
            </div>
            
            <div class="form-group">
                <label for="notes" class="form-label">–ü—Ä–∏–º–µ—á–∞–Ω–∏—è –∫ –∑–∞–∫–∞–∑—É</label>
                <textarea id="notes" name="notes" class="form-input" rows="3"></textarea>
            </div>
        </div>
        
        <button type="submit" class="place-order-btn" id="place-order-btn">
            –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
        </button>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã
        const moneyPayment = document.getElementById('money-payment');
        const crystalPayment = document.getElementById('crystal-payment');
        const totalPriceDisplay = document.getElementById('total-price-display');
        
        let selectedPaymentType = 'cash';
        
        moneyPayment.addEventListener('click', function() {
            moneyPayment.classList.add('active');
            crystalPayment.classList.remove('active');
            selectedPaymentType = 'cash';
            totalPriceDisplay.textContent = '{{ cart.total_price|floatformat:"0" }} ‚Ç∏';
        });
        
        crystalPayment.addEventListener('click', function() {
            crystalPayment.classList.add('active');
            moneyPayment.classList.remove('active');
            selectedPaymentType = 'crystals';
            totalPriceDisplay.textContent = 'üíé {{ cart.total_crystal_price }}';
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Ö–≤–∞—Ç–∞–µ—Ç –ª–∏ –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤
            const userCrystals = parseInt('{{ user.coin|default:0 }}');
            const cartCrystals = parseInt('{{ cart.total_crystal_price }}');
            
            if (userCrystals < cartCrystals) {
                alert('–£ –≤–∞—Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤ –¥–ª—è –æ–ø–ª–∞—Ç—ã –∑–∞–∫–∞–∑–∞');
                moneyPayment.click();
            }
        });
        
        // –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
        const checkoutForm = document.getElementById('checkout-form');
        const placeOrderBtn = document.getElementById('place-order-btn');
        
        checkoutForm.addEventListener('submit', function(event) {
            event.preventDefault();
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
            let isValid = validateForm();
            
            if (isValid) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
                placeOrderBtn.disabled = true;
                placeOrderBtn.innerHTML = '<span class="spinner"></span> –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞...';
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Ö–≤–∞—Ç–∞–µ—Ç –ª–∏ –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤ –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ –∫—Ä–∏—Å—Ç–∞–ª–ª–∞–º–∏
                if (selectedPaymentType === 'crystals') {
                    const userCrystals = parseInt('{{ user.coin|default:0 }}');
                    const cartCrystals = parseInt('{{ cart.total_crystal_price }}');
                    
                    if (userCrystals < cartCrystals) {
                        alert('–£ –≤–∞—Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤ –¥–ª—è –æ–ø–ª–∞—Ç—ã –∑–∞–∫–∞–∑–∞');
                        placeOrderBtn.disabled = false;
                        placeOrderBtn.innerHTML = '–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑';
                        return;
                    }
                }
                
                // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã
                const formData = new FormData();
                formData.append('hash', '{{ user.hash_code }}');
                formData.append('full_name', document.getElementById('full-name').value.trim());
                formData.append('phone_number', document.getElementById('phone').value.trim());
                formData.append('city', document.getElementById('city').value.trim());
                formData.append('address', document.getElementById('address').value.trim());
                formData.append('notes', document.getElementById('notes').value.trim());
                formData.append('payment_type', selectedPaymentType);
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
                fetch('{% url "shop:place_order" %}', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
                        showOrderSuccessModal(data.order_id);
                    } else {
                        alert(data.error || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞');
                        placeOrderBtn.disabled = false;
                        placeOrderBtn.innerHTML = '–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑';
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞');
                    placeOrderBtn.disabled = false;
                    placeOrderBtn.innerHTML = '–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑';
                });
            }
        });
        
        function validateForm() {
            // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
            const fullName = document.getElementById('full-name');
            const phone = document.getElementById('phone');
            const city = document.getElementById('city');
            const address = document.getElementById('address');
            
            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –æ—à–∏–±–∫–∏
            document.querySelectorAll('.error-message').forEach(el => {
                el.textContent = '';
            });
            
            let isValid = true;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –§–ò–û
            if (!fullName.value.trim()) {
                document.getElementById('full-name-error').textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –§–ò–û';
                isValid = false;
            }
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–ª–µ—Ñ–æ–Ω
            if (!phone.value.trim()) {
                document.getElementById('phone-error').textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω';
                isValid = false;
            } else if (!/^[\d\+\-\(\) ]+$/.test(phone.value.trim())) {
                document.getElementById('phone-error').textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞';
                isValid = false;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥–æ—Ä–æ–¥
            if (!city.value.trim()) {
                document.getElementById('city-error').textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –≥–æ—Ä–æ–¥';
                isValid = false;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–¥—Ä–µ—Å
            if (!address.value.trim()) {
                document.getElementById('address-error').textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏';
                isValid = false;
            }
            
            return isValid;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
        function showOrderSuccessModal(orderId) {
            // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            
            const modalContent = document.createElement('div');
            modalContent.className = 'modal-content';
            modalContent.style.textAlign = 'center';
            modalContent.style.padding = '30px';
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            modalContent.innerHTML = `
                <div style="width: 80px; height: 80px; background-color: #10b981; border-radius: 50%; display: flex; justify-content: center; align-items: center; margin: 0 auto 24px; color: white;">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-10 h-10">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
                    </svg>
                </div>
                
                <h2 style="font-size: 24px; font-weight: 700; margin-bottom: 16px; color: #10b981;">–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω!</h2>
                
                <p style="font-size: 16px; color: #6b7280; margin-bottom: 32px;">
                    –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –∑–∞–∫–∞–∑. –ú—ã —É–∂–µ –ø—Ä–∏—Å—Ç—É–ø–∏–ª–∏ –∫ –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∫–µ. 
                    ${selectedPaymentType === 'crystals' ? '–ö—Ä–∏—Å—Ç–∞–ª–ª—ã –±—ã–ª–∏ —É—Å–ø–µ—à–Ω–æ —Å–ø–∏—Å–∞–Ω—ã —Å –≤–∞—à–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞.' : '–í—ã –ø–æ–ª—É—á–∏—Ç–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–µ –ø–∏—Å—å–º–æ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º –∑–∞–∫–∞–∑–∞.'}
                </p>
                
                <div style="background-color: white; border-radius: 12px; padding: 24px; max-width: 500px; margin: 0 auto 32px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); text-align: left;">
                    <div style="font-weight: 600; font-size: 18px; margin-bottom: 16px; display: flex; justify-content: space-between;">
                        <span>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–∫–∞–∑–µ</span>
                        <span style="color: #6b7280; font-weight: normal;">#${orderId}</span>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 14px;">
                        <span style="color: #6b7280;">–î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞:</span>
                        <span>${new Date().toLocaleString()}</span>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 14px;">
                        <span style="color: #6b7280;">–°—Ç–∞—Ç—É—Å:</span>
                        <span>–û–∂–∏–¥–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏</span>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 14px;">
                        <span style="color: #6b7280;">–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:</span>
                        <span>${selectedPaymentType === 'cash' ? '–ù–∞–ª–∏—á–Ω—ã–º–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏' : '–ö—Ä–∏—Å—Ç–∞–ª–ª—ã'}</span>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 14px;">
                        <span style="color: #6b7280;">–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–∫–∞–∑–∞:</span>
                        <span>${selectedPaymentType === 'cash' ? '{{ cart.total_price|floatformat:"0" }} ‚Ç∏' : 'üíé {{ cart.total_crystal_price }}'}</span>
                    </div>
                </div>
                
                <div style="display: flex; gap: 16px; justify-content: center;">
                    <a href="{% url 'shop:shop' %}?hash={{ user.hash_code }}" style="padding: 12px 24px; border-radius: 8px; background-color: #2563eb; color: white; font-weight: 600; transition: all 0.3s ease;">
                        –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–∞–≥–∞–∑–∏–Ω
                    </a>
                </div>
            `;
            
            modal.appendChild(modalContent);
            document.body.appendChild(modal);
            
            // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –º–∞–≥–∞–∑–∏–Ω–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(function() {
                window.location.href = '{% url "shop:shop" %}?hash={{ user.hash_code }}';
            }, 5000);
        }
    });
</script>
{% endblock %}